<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¯ãƒªãƒƒã‚«ãƒ¼RPG</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/modal.css">
</head>
<body>
    <div class="game-container">
        <div class="stage-info">
            ã‚¹ãƒ†ãƒ¼ã‚¸ <span id="current-stage">1</span>
        </div>

        <div class="status-container">
            <div class="player-stats" id="player-stats">
                <!-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
            </div>
            <div class="enemy-stats">
                <div id="enemy-stats">
                    <!-- æ•µã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
                </div>
                <div class="health-bar-container">
                    <div class="health-bar" id="enemy-health-bar"></div>
                </div>
            </div>
        </div>

        <div class="command-area" id="command-area">
            <button id="attack-btn">æ”»æ’ƒ</button>
            <button id="skill-btn">ã‚¹ã‚­ãƒ«</button>
            <button id="item-btn">ã‚¢ã‚¤ãƒ†ãƒ </button>
            <button id="defend-btn">é˜²å¾¡</button>
        </div>        <div class="menu-button">
            <button onclick="openModal()">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</button>
        </div>
    </div>    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="game-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <h2 class="modal-title">ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="tab-container">            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('shop')">ã‚·ãƒ§ãƒƒãƒ—</button>
                <button class="tab-button" onclick="showTab('inventory')">ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒª</button>
                <button class="tab-button" onclick="showTab('skills')">ã‚¹ã‚­ãƒ«</button>
                <button class="tab-button" onclick="showTab('stats')">çµ±è¨ˆ</button>
                <button class="tab-button" onclick="showTab('settings')">è¨­å®š</button>
            </div>
                <div id="shop-tab" class="tab-content active">
                    <div class="shop-grid" id="shop-items"></div>
                </div>
                <div id="inventory-tab" class="tab-content">
                    <div class="inventory-grid" id="inventory-items"></div>
                </div>
                <div id="skills-tab" class="tab-content">
                    <div class="skill-tree" id="skill-tree"></div>
                </div>                <div id="stats-tab" class="tab-content">
                    <h3>ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼çµ±è¨ˆ</h3>
                    <div class="stats-container"></div>
                </div>
                <div id="settings-tab" class="tab-content">
                    <h3>ã‚²ãƒ¼ãƒ è¨­å®š</h3>
                    <button onclick="toggleSound()" id="sound-toggle">ğŸ”Š ã‚µã‚¦ãƒ³ãƒ‰ON</button>
                </div>
            </div>
        </div>
    </div>
    <div id="skill-modal" class="modal-overlay" style="display:none;">
        <div class="modal-container" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">ã‚¹ã‚­ãƒ«é¸æŠ</h2>
                <button class="modal-close" onclick="closeSkillModal()">&times;</button>
            </div>
            <div class="modal-body" id="skill-modal-body"></div>
        </div>
    </div>
    <div id="item-modal" class="modal-overlay" style="display:none;">
        <div class="modal-container" style="max-width:400px;">
            <div class="modal-header">
                <h2 class="modal-title">ã‚¢ã‚¤ãƒ†ãƒ é¸æŠ</h2>
                <button class="modal-close" onclick="closeItemModal()">&times;</button>
            </div>
            <div class="modal-body" id="item-modal-body"></div>
        </div>
    </div>

    <script src="js/music.js"></script>
    <script src="js/game.js"></script>
    <script>
    // ã‚¿ãƒ¼ãƒ³åˆ¶ãƒãƒˆãƒ«ç”¨ã‚³ãƒãƒ³ãƒ‰UIã®ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('attack-btn').onclick = () => handleCommand('attack');
        document.getElementById('skill-btn').onclick = () => handleCommand('skill');
        document.getElementById('item-btn').onclick = () => handleCommand('item');
        document.getElementById('defend-btn').onclick = () => handleCommand('defend');
    });    // ã‚¹ã‚­ãƒ«ãƒ»ã‚¢ã‚¤ãƒ†ãƒ é¸æŠãƒ¢ãƒ¼ãƒ€ãƒ«ã®åˆ¶å¾¡
    function openSkillModal(skills, onSelect) {
        const modal = document.getElementById('skill-modal');
        const body = document.getElementById('skill-modal-body');
        body.innerHTML = '';
        
        if (skills.length === 0) {
            body.innerHTML = '<p style="text-align: center; color: #999;">ä½¿ç”¨å¯èƒ½ãªã‚¹ã‚­ãƒ«ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        } else {
            skills.forEach(skill => {
                const skillDiv = document.createElement('div');
                skillDiv.className = 'skill-item';
                skillDiv.innerHTML = `
                    <div>
                        <div class="skill-item-name">${skill.name}</div>
                        <div class="skill-item-desc">${skill.description || ''}</div>
                    </div>
                    <div class="skill-item-cost">MP: ${skill.manaCost || 0}</div>
                `;
                skillDiv.onclick = () => { 
                    closeSkillModal(); 
                    onSelect(skill); 
                };
                body.appendChild(skillDiv);
            });
        }
        modal.style.display = 'block';
    }
    
    function closeSkillModal() {
        document.getElementById('skill-modal').style.display = 'none';
    }
    
    function openItemModal(items, onSelect) {
        const modal = document.getElementById('item-modal');
        const body = document.getElementById('item-modal-body');
        body.innerHTML = '';
        
        if (items.length === 0) {
            body.innerHTML = '<p style="text-align: center; color: #999;">ä½¿ç”¨å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ãŒã‚ã‚Šã¾ã›ã‚“</p>';
        } else {
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'inventory-item';
                itemDiv.innerHTML = `
                    <div>
                        <div class="inventory-item-name">${item.name}</div>
                        <div class="inventory-item-desc">${item.description || ''}</div>
                    </div>
                `;
                itemDiv.onclick = () => { 
                    closeItemModal(); 
                    onSelect(item); 
                };
                body.appendChild(itemDiv);
            });
        }
        modal.style.display = 'block';
    }
    function closeItemModal() {
        document.getElementById('item-modal').style.display = 'none';
    }
    // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    window.onclick = function(event) {
        ['skill-modal','item-modal','game-modal'].forEach(id => {
            const modal = document.getElementById(id);
            if (event.target === modal) modal.style.display = 'none';
        });
    };
    </script>
</body>
</html>